<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>注册账户汇款</title>
    <script src="layui/layui.js"></script>
    <link rel="stylesheet" href="layui/css/layui.css">
    <script src="js/jquery-3.3.1.min.js"></script>
</head>

<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo">银行管理系统</div>
        <!-- 头部区域（可配合layui已有的水平导航） -->
        <ul class="layui-nav layui-layout-left">
            <li class="layui-nav-item"><a href="">控制台</a></li>
            <li class="layui-nav-item"><a href="">商品管理</a></li>
            <li class="layui-nav-item"><a href="">用户</a></li>
            <li class="layui-nav-item">
                <a href="javascript:;">其它系统</a>
                <dl class="layui-nav-child">
                    <dd><a href="">邮件管理</a></dd>
                    <dd><a href="">消息管理</a></dd>
                    <dd><a href="">授权管理</a></dd>
                </dl>
            </li>
        </ul>
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="javascript:;">
                    <img src="http://t.cn/RCzsdCq" class="layui-nav-img">
                    管理员
                </a>
                <dl class="layui-nav-child">
                    <dd><a href="">基本资料</a></dd>
                    <dd><a href="">安全设置</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item"><a href="Login.html">退出登录</a></li>
        </ul>
    </div>

    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
            <ul class="layui-nav layui-nav-tree" lay-filter="test">
                <li class="layui-nav-item layui-nav-itemed">
                    <a class="" href="javascript:;">汇款转账</a>
                    <dl class="layui-nav-child">
                        <dd><a href="javascript:;">境内汇款</a>
                            <dl class="layui-nav-child">
                                <dd><a href="SingleRemittance.html">单笔汇款</a></dd>
                                <dd><a href="AccountRemittance.html">注册账号汇款</a></dd>
                                <dd><a href="BatchRemittance.html">批量汇款</a></dd>
                            </dl>
                        </dd>
                        <dd><a href="javascript:;">境外汇款</a>
                            <dl class="layui-nav-child">
                                <dd><a href="javascript:;">单笔汇款</a></dd>
                            </dl>
                        </dd>
                    </dl>
                </li>
                <li class="layui-nav-item">
                    <a href="javascript:;">我的账户</a>
                    <dl class="layui-nav-child">
                        <dd><a href="javascript:;">银行卡</a></dd>
                        <dd><a href="javascript:;">账户申请</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item"><a href="">功能小助手</a></li>
            </ul>
        </div>
    </div>

    <div class="layui-body">
        <!-- 内容主体区域 -->
        <div style="padding: 15px;">
            <form class="layui-form" action="#" method="get">

                <input type="hidden" id="rem_time" name="rem_time" value="">
                <input type="hidden" id="rem_currency" name="rem_currency" value="1">
                <!--<input type="hidden" name="" value="">-->
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label">汇款姓名</label>
                        <div class="layui-input-inline" style="width: 150px;">
                            <input type="text" name="rem_remittancename" id="rem_remittancename" required
                                   placeholder="姓名"
                                   autocomplete="off" class="layui-input" readonly="readonly">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label">汇款卡号</label>
                        <div class="layui-input-inline" style="width: 350px;">
                            <input type="text" id="rem_remittancenum" name="rem_remittancenum" required
                                   lay-verify="required" placeholder="请输入卡号"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label">汇款银行</label>
                        <div class="layui-input-block" style="width: 200px;">
                            <select id="rem_remittancebank" lay-verify="required" lay-search="" disabled="">
                                <option value="">直接选择或搜索选择</option>
                                <option value="1" name="rem_remittancebank" selected>知领银行</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label"><!--姓名--></label>
                        <div class="layui-input-inline" style="width: 150px;">
                            <input type="text" id="rem_receivename" name="rem_receivename" required
                                   placeholder="姓名"
                                   autocomplete="off" class="layui-input" readonly="readonly">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label">收款卡号</label>
                        <div class="layui-input-inline" style="width: 350px;">
                            <input type="text" id="rem_receivenum" name="rem_receivenum" required lay-verify="required"
                                   placeholder="请输入卡号"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-inline">
                        <label class="layui-form-label">汇款银行</label>
                        <div class="layui-input-block" style="width: 200px;">
                            <select id="rem_remittancebank" lay-verify="required" lay-search="" disabled="">
                                <option value="">直接选择或搜索选择</option>
                                <option value="1" name="rem_remittancebank" selected>知领银行</option>
                            </select>
                        </div>
                    </div>
                    <hr class="layui-bg-gray">
                </div>
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label">汇款途径</label>
                        <div class="layui-input-block" style="width: 300px;">
                            <select id="rem_usetrance" lay-verify="required">
                                <option value="1" name="rem_usetrance" disabled="">代表代发工资</option>
                                <option value="2" name="rem_usetrance" selected>单笔汇款</option>
                                <option value="3" name="rem_usetrance" disabled="">批量汇款</option>
                                <option value="4" name="rem_usetrance" disabled="">注册账户汇款</option>
                            </select>
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label">手机号</label>
                        <div class="layui-input-inline" style="width: 250px;">
                            <input type="rem_phone" id="rem_phone" name="rem_phone" lay-verify="required|phone"
                                   autocomplete="off"
                                   class="layui-input">
                        </div>
                    </div>

                    <div class="layui-inline">
                        <label class="layui-form-label">支付密码</label>
                        <div class="layui-input-inline" style="width: 250px;">
                            <input type="password" id="pwd" name="pwd" lay-verify="required|phone"
                                   autocomplete="off"
                                   class="layui-input">
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label">汇款金额</label>
                        <div class="layui-input-inline">
                            <input type="text" id="rem_money" name="rem_money" required lay-verify="required"
                                   placeholder="￥"
                                   autocomplete="off" class="layui-input">
                        </div>
                        <div class="layui-form-mid layui-word-aux">
                            <span style="color: red;" id="span"></span>
                        </div>
                    </div>

                </div>


                <div class="layui-form-item">
                    <label class="layui-form-label">短信通知</label>
                    <div class="layui-input-block">
                        <input type="checkbox" lay-skin="switch" checked disabled="">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">到账类型</label>
                    <div class="layui-input-block" id="rem_accountingtype">
                        <input type="radio" name="rem_accountingtype" value="0" title="实时汇款" checked>
                        <input type="radio" name="rem_accountingtype" value="1" title="普通汇款" disabled="">
                        <input type="radio" name="rem_accountingtype" value="2" title="次日汇款" disabled="">
                    </div>
                </div>
                <!--<div class="layui-form-item layui-form-text">-->
                <!--<label class="layui-form-label">附言</label>-->
                <!--<div class="layui-input-block">-->
                <!--<textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>-->
                <!--</div>-->
                <!--</div>-->
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button type="button" class="layui-btn" id="submit" lay-submit lay-filter="">下一步</button>
                        <!--<input type="button" id="submit" value="下一步">-->
                        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                    </div>
                </div>
            </form>
            <hr class="layui-bg-gray">
            <div>
                相关协议及手续费说明...
            </div>
            <script>
                //Demo
                layui.use('form', function () {
                    var form = layui.form;
                });
            </script>

        </div>
    </div>

    <div class="layui-footer">
        <!-- 底部固定区域 -->
        &copy;本产品由马轶博小组开发,版权所有,请勿侵权!
    </div>
</div>
<script>
    //JavaScript代码区域
    layui.use('element', function () {
        var element = layui.element;

    });

</script>
<script type="text/javascript">
    $(function () {
        $("#submit").click(function () {
            var remittance = {
                "rem_receivename": $('#rem_receivename').val(),
                "pwd": $('#pwd').val(),
                "rem_receivenum": $('#rem_receivenum').val(),
                "rem_receivebank": $("option[name='rem_receivebank']:checked").val(),
                "rem_usetrance": $("option[name='rem_usetrance']:checked").val(),
                // "rem_time":dateFormat($('#rem_time').datebox('getValue')),
                "rem_remittancenum": $('#rem_remittancenum').val(),
                "rem_remittancename": $('#rem_remittancename').val(),
                "rem_remittancebank": $("option[name='rem_remittancebank']:selected").val(),
                "rem_currency": $('#rem_currency').val(),
                "rem_money": $('#rem_money').val(),
                "rem_accountingtype": $("input[name='rem_accountingtype']:checked").val(),
                "rem_phone": $('#rem_phone').val()
            }
            console.log(remittance)
            $.post("", remittance, function (flag) {
                if ("OK" == flag) {
                    window.location.href = "";
                }
            })
        })

        $("#rem_money").blur(function () {
            var bankcard = null;
            var elem = $("#rem_remittancenum");
            $.ajax({
                url: "/bankcard/findByIdCard",
                type: "get",
                data: {bc_number: elem.val()},
                dataType: "json",
                success: function (idCard) {
                    bankcard = idCard;
                    console.log(bankcard);
                    if (bankcard.bc_money < $("#rem_money").val()) {
                        $("#span").html("余额不足,无法转账!");
                    } else {
                        $("#span").html("");
                    }
                }
            })
        })

        $("#rem_receivenum").blur(function () {
            var bankcard = null;
            var elem = $("#rem_receivebank");
            $.ajax({
                url: "/bankcard/findByIdCard",
                type: "get",
                data: {bc_number: $("#rem_receivenum").val()},
                dataType: "json",
                success: function (idCard) {
                    bankcard = idCard;
                    console.log(bankcard);
                    elem.val(bankcard.bankcardType.bct_name);
                }
            })
        })
    })
</script>
</body>
</html>